import{u as xe,a as De,b as O,g as vu,c as mu,p as fu,h as Fu,d as cu,e as Du,f as yu,i as gu}from"./order.bf90f52f.js";import{_ as _u,d as Bu,y as z,r as F,o as Eu,b as y,H as Cu,e as v,f as C,g as u,h as l,j as o,i as c,I as Ie,m as A,t as d,k as b,F as h,l as re,z as S,L as bu,E as g,M as Re,N as Au}from"./index.2cc8de7c.js";import{u as Vu}from"./upload.a442cc91.js";import"./request.12a390b5.js";const ku={class:"order-container"},Su={class:"pagination"},wu={class:"order-items"},xu={key:0,class:"delivery-info"},Iu={key:0,class:"delivery-timeline"},Ru={key:1,class:"delivery-actions"},Nu={key:1,class:"refund-info"},Uu={class:"proof-images"},Pu={class:"image-error"},Tu={key:0,class:"refund-actions"},qu={class:"dialog-footer"},Ou=["src"],zu={class:"dialog-footer"},hu={class:"order-items"},Mu={class:"product-info"},$u={class:"product-name"},ju={key:0,class:"sku-name"},Lu={class:"price"},Ju={class:"total"},Hu={class:"total-amount"},Wu={class:"dialog-footer"},Gu={class:"product-search"},Ku={class:"pagination"},Qu={key:0},Xu={class:"dialog-footer"},Yu={class:"dialog-footer"},Zu=Bu({__name:"index",setup(el){const I=z({orderNo:"",status:""}),oe=F(!1),M=F([]),$=F(1),ee=F(10),j=F(0),se=F(!1),a=F({}),L=F(!1),de=F(),w=z({deliveryCompany:"",deliverySn:""}),Ne={deliveryCompany:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6D41\u516C\u53F8",trigger:"blur"}],deliverySn:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6D41\u5355\u53F7",trigger:"blur"}]},U=F(!1),ne=F(),p=z({refundAmount:0,reason:"",description:"",proofImages:"[]",status:1,rejectReason:""}),ie=F(!1),ye=F(""),Ue={refundAmount:[{required:!0,message:"\u8BF7\u8F93\u5165\u9000\u6B3E\u91D1\u989D",trigger:"blur"}],reason:[{required:!0,message:"\u8BF7\u8F93\u5165\u9000\u6B3E\u539F\u56E0",trigger:"blur"}],description:[{required:!0,message:"\u8BF7\u8F93\u5165\u9000\u6B3E\u8BF4\u660E",trigger:"blur"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u5904\u7406\u7ED3\u679C",trigger:"change"}],rejectReason:[{required:!0,message:"\u8BF7\u8F93\u5165\u62D2\u7EDD\u539F\u56E0",trigger:"blur"}]},J=F(!1),pe=F(),i=z({userId:"",totalAmount:0,payAmount:0,freightAmount:0,payType:1,receiverName:"",receiverPhone:"",receiverAddress:"",note:"",orderItems:[]}),Pe={userId:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237ID",trigger:"blur"},{pattern:/^\d+$/,message:"\u7528\u6237ID\u5FC5\u987B\u4E3A\u6570\u5B57",trigger:"blur"}],receiverName:[{required:!0,message:"\u8BF7\u8F93\u5165\u6536\u8D27\u4EBA\u59D3\u540D",trigger:"blur"}],receiverPhone:[{required:!0,message:"\u8BF7\u8F93\u5165\u6536\u8D27\u4EBA\u7535\u8BDD",trigger:"blur"}],receiverAddress:[{required:!0,message:"\u8BF7\u8F93\u5165\u6536\u8D27\u5730\u5740",trigger:"blur"}],orderItems:[{required:!0,message:"\u8BF7\u6DFB\u52A0\u5546\u54C1",trigger:"change"}]},H=F(!1),W=F([]),ve=F(!1),G=F(0),P=F(1),ue=F(10),V=z({name:"",status:""}),K=F(!1),R=F(null),Q=F(""),Te=r=>({0:"warning",1:"primary",2:"success"})[r]||"info",qe=r=>({0:"\u5F85\u53D1\u8D27",1:"\u5DF2\u53D1\u8D27",2:"\u5DF2\u7B7E\u6536"})[r]||"\u672A\u77E5",X=F(!1),me=F(),_=z({deliveryCompany:"",deliverySn:"",status:1,deliveryInfo:""}),Oe={deliveryCompany:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6D41\u516C\u53F8",trigger:"blur"}],deliverySn:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6D41\u5355\u53F7",trigger:"blur"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u7269\u6D41\u72B6\u6001",trigger:"change"}],deliveryInfo:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u6D41\u4FE1\u606F",trigger:"blur"}]},ze=()=>{a.value.orderDelivery&&(_.deliveryCompany=a.value.orderDelivery.deliveryCompany,_.deliverySn=a.value.orderDelivery.deliverySn,_.status=a.value.orderDelivery.status,_.deliveryInfo=""),X.value=!0},he=async()=>{!me.value||await me.value.validate(async r=>{if(r)try{const e=a.value.orderDelivery.deliveryInfo?JSON.parse(a.value.orderDelivery.deliveryInfo):[],n={time:new Date().toLocaleString(),info:_.deliveryInfo};e.unshift(n),await xe(String(a.value.id),{deliveryCompany:_.deliveryCompany,deliverySn:_.deliverySn,receiverName:a.value.receiverName,receiverPhone:a.value.receiverPhone,receiverAddress:a.value.receiverAddress,deliveryInfo:JSON.stringify(e)}),await De(String(a.value.id),{status:_.status}),_.status===2&&await O(String(a.value.id),{status:3}),g.success("\u7269\u6D41\u4FE1\u606F\u66F4\u65B0\u6210\u529F"),X.value=!1,Ee(a.value)}catch(e){console.error("\u66F4\u65B0\u7269\u6D41\u4FE1\u606F\u5931\u8D25:",e),g.error("\u66F4\u65B0\u7269\u6D41\u4FE1\u606F\u5931\u8D25")}})},x=async()=>{oe.value=!0;try{const r={pageSize:ee.value,pageNum:$.value,...I},e=await vu(r);e.success&&e.data?(M.value=e.data.records||[],j.value=e.data.total||0):e.records?(M.value=e.records,j.value=e.total||e.records.length):(M.value=[],j.value=0)}catch(r){console.error("\u83B7\u53D6\u8BA2\u5355\u5217\u8868\u5931\u8D25:",r),M.value=[],j.value=0}finally{oe.value=!1}},ge=()=>{$.value=1,x()},Me=()=>{I.orderNo="",I.status="",ge()},_e=r=>({0:"warning",1:"primary",2:"success",3:"info",4:"danger",5:"danger",6:"warning"})[r]||"info",Be=r=>({0:"\u5F85\u4ED8\u6B3E",1:"\u5F85\u53D1\u8D27",2:"\u5F85\u6536\u8D27",3:"\u5DF2\u5B8C\u6210",4:"\u5DF2\u53D6\u6D88",5:"\u5DF2\u9000\u6B3E",6:"\u5F85\u5904\u7406\u9000\u6B3E"})[r]||"\u672A\u77E5",$e=r=>({0:"warning",1:"success",2:"danger",3:"info"})[r]||"info",je=r=>({0:"\u5F85\u5904\u7406",1:"\u5DF2\u540C\u610F",2:"\u5DF2\u62D2\u7EDD",3:"\u5DF2\u5B8C\u6210"})[r]||"\u672A\u77E5",Ee=async r=>{try{const e=await mu(String(r.id));e.success&&e.data&&(a.value=e.data,se.value=!0)}catch(e){console.error("\u83B7\u53D6\u8BA2\u5355\u8BE6\u60C5\u5931\u8D25:",e)}},Le=r=>{a.value=r,w.deliveryCompany="",w.deliverySn="",L.value=!0},Je=async()=>{!de.value||await de.value.validate(async r=>{var e,n;if(r)try{await xe(String(a.value.id),{deliveryCompany:w.deliveryCompany,deliverySn:w.deliverySn,receiverName:a.value.receiverName,receiverPhone:a.value.receiverPhone,receiverAddress:a.value.receiverAddress,deliveryInfo:JSON.stringify([{time:new Date().toLocaleString(),info:"\u5FEB\u4EF6\u5DF2\u53D1\u51FA"}]),status:1}),await De(String(a.value.id),{status:1}),await O(String(a.value.id),{status:2}),g.success("\u53D1\u8D27\u6210\u529F"),L.value=!1,x()}catch(s){g.error(((n=(e=s.response)==null?void 0:e.data)==null?void 0:n.message)||"\u53D1\u8D27\u5931\u8D25")}})},He=async r=>{var e,n;try{await De(String(r.id),{status:2}),await O(String(r.id),{status:3}),g.success("\u786E\u8BA4\u6536\u8D27\u6210\u529F"),x()}catch(s){g.error(((n=(e=s.response)==null?void 0:e.data)==null?void 0:n.message)||"\u786E\u8BA4\u6536\u8D27\u5931\u8D25")}},Ce=r=>{a.value=r,p.status=1,p.rejectReason="",U.value=!0},We=r=>{a.value=r,p.refundAmount=r.totalAmount,p.reason="",p.description="",p.proofImages="[]",U.value=!0},Ge=async()=>{!ne.value||await ne.value.validate(async r=>{var e,n;if(r)try{a.value.orderRefund?(await fu(String(a.value.id),{status:p.status,rejectReason:p.rejectReason}),p.status===1?await O(String(a.value.id),{status:5}):p.status===2&&await O(String(a.value.id),{status:4}),g.success("\u9000\u6B3E\u5904\u7406\u6210\u529F")):(await Fu(String(a.value.id),{refundAmount:p.refundAmount,reason:p.reason,description:p.description,proofImages:p.proofImages}),await O(String(a.value.id),{status:6}),g.success("\u9000\u6B3E\u7533\u8BF7\u63D0\u4EA4\u6210\u529F")),U.value=!1,x()}catch(s){g.error(((n=(e=s.response)==null?void 0:e.data)==null?void 0:n.message)||"\u9000\u6B3E\u5904\u7406\u5931\u8D25")}})},Ke=async r=>{var e,n;try{await cu(String(r.id)),g.success("\u5220\u9664\u8BA2\u5355\u6210\u529F"),x()}catch(s){g.error(((n=(e=s.response)==null?void 0:e.data)==null?void 0:n.message)||"\u5220\u9664\u8BA2\u5355\u5931\u8D25")}},Qe=r=>{ee.value=r,x()},Xe=r=>{$.value=r,x()},Ye=()=>{i.userId="",i.totalAmount=0,i.payAmount=0,i.freightAmount=0,i.payType=1,i.receiverName="",i.receiverPhone="",i.receiverAddress="",i.note="",i.orderItems=[],J.value=!0},le=async()=>{ve.value=!0;try{const r={size:ue.value,page:P.value,...V},e=await gu(r);e.success&&e.data?(W.value=e.data.records||[],G.value=e.data.total||0):e.records?(W.value=e.records,G.value=e.total||e.records.length):(W.value=[],G.value=0)}catch(r){console.error("\u83B7\u53D6\u5546\u54C1\u5217\u8868\u5931\u8D25:",r),W.value=[],G.value=0}finally{ve.value=!1}},Ze=async r=>{try{const e=await Du(String(r.id));if(e.success&&e.data){const n=e.data;n.skuList&&n.skuList.length>0?(R.value=n,Q.value="",K.value=!0):g.warning("\u8BE5\u5546\u54C1\u6CA1\u6709\u89C4\u683C\u4FE1\u606F\uFF0C\u65E0\u6CD5\u6DFB\u52A0\u5230\u8BA2\u5355"),H.value=!1}}catch(e){console.error("\u83B7\u53D6\u5546\u54C1\u8BE6\u60C5\u5931\u8D25:",e)}},eu=()=>{if(!R.value||!Q.value)return;const r=R.value.skuList.find(e=>e.id===Q.value);r&&(i.orderItems.push({productId:R.value.id,skuId:r.id,productName:R.value.name,skuName:r.name,productPic:R.value.mainImage,price:r.price,quantity:1,totalAmount:r.price}),te()),K.value=!1,H.value=!1},uu=()=>{V.name="",V.status="",P.value=1,le(),H.value=!0},be=()=>{P.value=1,le()},lu=r=>{ue.value=r,le()},tu=r=>{P.value=r,le()},te=()=>{const r=i.orderItems.reduce((e,n)=>e+n.totalAmount,0);i.totalAmount=r+i.freightAmount,i.payAmount=i.totalAmount},au=r=>{const e=i.orderItems[r];e.totalAmount=e.price*e.quantity,te()},ru=r=>{i.orderItems.splice(r,1),te()},ou=async()=>{!pe.value||await pe.value.validate(async r=>{var e,n;if(r)try{await yu(i),g.success("\u521B\u5EFA\u8BA2\u5355\u6210\u529F"),J.value=!1,x()}catch(s){g.error(((n=(e=s.response)==null?void 0:e.data)==null?void 0:n.message)||"\u521B\u5EFA\u8BA2\u5355\u5931\u8D25")}})};return Eu(()=>{x()}),(r,e)=>{const n=y("el-input"),s=y("el-form-item"),E=y("el-option"),Y=y("el-select"),m=y("el-button"),T=y("el-form"),Ae=y("el-card"),B=y("el-table-column"),Z=y("el-tag"),fe=y("el-table"),Ve=y("el-pagination"),D=y("el-descriptions-item"),Fe=y("el-descriptions"),su=y("el-timeline-item"),du=y("el-timeline"),ae=y("el-icon"),ke=y("el-image"),N=y("el-dialog"),Se=y("el-radio"),nu=y("el-radio-group"),ce=y("el-input-number"),iu=y("el-upload"),q=y("el-col"),pu=y("el-row"),we=Cu("loading");return v(),C("div",ku,[u(Ae,{class:"search-card"},{default:l(()=>[u(T,{inline:!0,model:I,class:"search-form"},{default:l(()=>[u(s,{label:"\u8BA2\u5355\u7F16\u53F7"},{default:l(()=>[u(n,{modelValue:I.orderNo,"onUpdate:modelValue":e[0]||(e[0]=t=>I.orderNo=t),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u7F16\u53F7",clearable:""},null,8,["modelValue"])]),_:1}),u(s,{label:"\u8BA2\u5355\u72B6\u6001"},{default:l(()=>[u(Y,{modelValue:I.status,"onUpdate:modelValue":e[1]||(e[1]=t=>I.status=t),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",clearable:""},{default:l(()=>[u(E,{label:"\u5F85\u4ED8\u6B3E",value:0}),u(E,{label:"\u5F85\u53D1\u8D27",value:1}),u(E,{label:"\u5F85\u6536\u8D27",value:2}),u(E,{label:"\u5DF2\u5B8C\u6210",value:3}),u(E,{label:"\u5DF2\u53D6\u6D88",value:4}),u(E,{label:"\u5DF2\u9000\u6B3E",value:5}),u(E,{label:"\u5F85\u5904\u7406\u9000\u6B3E",value:6})]),_:1},8,["modelValue"])]),_:1}),u(s,null,{default:l(()=>[u(m,{type:"primary",onClick:ge},{default:l(()=>e[42]||(e[42]=[o("\u641C\u7D22")])),_:1,__:[42]}),u(m,{onClick:Me},{default:l(()=>e[43]||(e[43]=[o("\u91CD\u7F6E")])),_:1,__:[43]}),u(m,{type:"success",onClick:Ye},{default:l(()=>e[44]||(e[44]=[o("\u521B\u5EFA\u8BA2\u5355")])),_:1,__:[44]})]),_:1})]),_:1},8,["model"])]),_:1}),u(Ae,{class:"table-card"},{header:l(()=>e[45]||(e[45]=[c("div",{class:"card-header"},[c("span",null,"\u8BA2\u5355\u5217\u8868")],-1)])),default:l(()=>[Ie((v(),A(fe,{data:M.value,border:"",style:{width:"100%"}},{default:l(()=>[u(B,{prop:"orderNo",label:"\u8BA2\u5355\u7F16\u53F7","min-width":"180","show-overflow-tooltip":""}),u(B,{prop:"totalAmount",label:"\u8BA2\u5355\u91D1\u989D",width:"120",align:"right"},{default:l(({row:t})=>[o(" \xA5"+d(t.totalAmount.toFixed(2)),1)]),_:1}),u(B,{prop:"payType",label:"\u652F\u4ED8\u65B9\u5F0F",width:"100",align:"center"},{default:l(({row:t})=>[o(d(t.payType===1?"\u5FAE\u4FE1\u652F\u4ED8":"\u652F\u4ED8\u5B9D"),1)]),_:1}),u(B,{prop:"status",label:"\u8BA2\u5355\u72B6\u6001",width:"100",align:"center"},{default:l(({row:t})=>[u(Z,{type:_e(t.status)},{default:l(()=>[o(d(Be(t.status)),1)]),_:2},1032,["type"])]),_:1}),u(B,{prop:"receiverName",label:"\u6536\u8D27\u4EBA",width:"100",align:"center"}),u(B,{prop:"receiverPhone",label:"\u8054\u7CFB\u7535\u8BDD",width:"120",align:"center"}),u(B,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4",width:"180",align:"center"}),u(B,{label:"\u64CD\u4F5C",width:"250",fixed:"right",align:"center"},{default:l(({row:t})=>[u(m,{type:"primary",link:"",onClick:f=>Ee(t)},{default:l(()=>e[46]||(e[46]=[o("\u8BE6\u60C5")])),_:2,__:[46]},1032,["onClick"]),t.status===1?(v(),A(m,{key:0,type:"success",link:"",onClick:f=>Le(t)},{default:l(()=>e[47]||(e[47]=[o("\u53D1\u8D27")])),_:2,__:[47]},1032,["onClick"])):b("",!0),t.status===2?(v(),A(m,{key:1,type:"warning",link:"",onClick:f=>He(t)},{default:l(()=>e[48]||(e[48]=[o("\u786E\u8BA4\u6536\u8D27")])),_:2,__:[48]},1032,["onClick"])):b("",!0),t.status===3&&t.orderRefund===null?(v(),A(m,{key:2,type:"danger",link:"",onClick:f=>We(t)},{default:l(()=>e[49]||(e[49]=[o("\u7533\u8BF7\u9000\u6B3E")])),_:2,__:[49]},1032,["onClick"])):b("",!0),t.orderRefund!==null&&t.orderRefund.status===0?(v(),A(m,{key:3,type:"warning",link:"",onClick:f=>Ce(t)},{default:l(()=>e[50]||(e[50]=[o("\u5904\u7406\u9000\u6B3E")])),_:2,__:[50]},1032,["onClick"])):b("",!0),u(m,{type:"danger",link:"",onClick:f=>Ke(t)},{default:l(()=>e[51]||(e[51]=[o("\u5220\u9664")])),_:2,__:[51]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[we,oe.value]]),c("div",Su,[u(Ve,{"current-page":$.value,"onUpdate:currentPage":e[2]||(e[2]=t=>$.value=t),"page-size":ee.value,"onUpdate:pageSize":e[3]||(e[3]=t=>ee.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:j.value,onSizeChange:Qe,onCurrentChange:Xe},null,8,["current-page","page-size","total"])])]),_:1}),u(N,{modelValue:se.value,"onUpdate:modelValue":e[5]||(e[5]=t=>se.value=t),title:"\u8BA2\u5355\u8BE6\u60C5",width:"800px"},{default:l(()=>[u(Fe,{column:2,border:""},{default:l(()=>[u(D,{label:"\u8BA2\u5355\u7F16\u53F7"},{default:l(()=>[o(d(a.value.orderNo),1)]),_:1}),u(D,{label:"\u8BA2\u5355\u72B6\u6001"},{default:l(()=>[u(Z,{type:_e(a.value.status)},{default:l(()=>[o(d(Be(a.value.status)),1)]),_:1},8,["type"])]),_:1}),u(D,{label:"\u8BA2\u5355\u91D1\u989D"},{default:l(()=>{var t;return[o("\xA5"+d((t=a.value.totalAmount)==null?void 0:t.toFixed(2)),1)]}),_:1}),u(D,{label:"\u652F\u4ED8\u65B9\u5F0F"},{default:l(()=>[o(d(a.value.payType===1?"\u5FAE\u4FE1\u652F\u4ED8":"\u652F\u4ED8\u5B9D"),1)]),_:1}),u(D,{label:"\u6536\u8D27\u4EBA"},{default:l(()=>[o(d(a.value.receiverName),1)]),_:1}),u(D,{label:"\u8054\u7CFB\u7535\u8BDD"},{default:l(()=>[o(d(a.value.receiverPhone),1)]),_:1}),u(D,{label:"\u6536\u8D27\u5730\u5740",span:2},{default:l(()=>[o(d(a.value.receiverAddress),1)]),_:1}),u(D,{label:"\u8BA2\u5355\u5907\u6CE8",span:2},{default:l(()=>[o(d(a.value.note||"\u65E0"),1)]),_:1})]),_:1}),c("div",wu,[e[52]||(e[52]=c("h3",null,"\u5546\u54C1\u4FE1\u606F",-1)),u(fe,{data:a.value.orderItems||[],border:""},{default:l(()=>[u(B,{prop:"productName",label:"\u5546\u54C1\u540D\u79F0"}),u(B,{prop:"skuName",label:"\u89C4\u683C"}),u(B,{prop:"price",label:"\u5355\u4EF7",width:"120"},{default:l(({row:t})=>[o(" \xA5"+d(t.price.toFixed(2)),1)]),_:1}),u(B,{prop:"quantity",label:"\u6570\u91CF",width:"100"}),u(B,{prop:"totalAmount",label:"\u5C0F\u8BA1",width:"120"},{default:l(({row:t})=>[o(" \xA5"+d(t.totalAmount.toFixed(2)),1)]),_:1})]),_:1},8,["data"])]),a.value.orderDelivery?(v(),C("div",xu,[e[55]||(e[55]=c("h3",null,"\u7269\u6D41\u4FE1\u606F",-1)),u(Fe,{column:2,border:""},{default:l(()=>[u(D,{label:"\u7269\u6D41\u516C\u53F8"},{default:l(()=>[o(d(a.value.orderDelivery.deliveryCompany),1)]),_:1}),u(D,{label:"\u7269\u6D41\u5355\u53F7"},{default:l(()=>[o(d(a.value.orderDelivery.deliverySn),1)]),_:1}),u(D,{label:"\u53D1\u8D27\u65F6\u95F4"},{default:l(()=>[o(d(a.value.orderDelivery.deliveryTime),1)]),_:1}),u(D,{label:"\u7B7E\u6536\u65F6\u95F4"},{default:l(()=>[o(d(a.value.orderDelivery.receiveTime||"\u672A\u7B7E\u6536"),1)]),_:1}),u(D,{label:"\u7269\u6D41\u72B6\u6001"},{default:l(()=>[u(Z,{type:Te(a.value.orderDelivery.status)},{default:l(()=>[o(d(qe(a.value.orderDelivery.status)),1)]),_:1},8,["type"])]),_:1}),u(D,{label:"\u6536\u8D27\u4EBA"},{default:l(()=>[o(d(a.value.orderDelivery.receiverName),1)]),_:1}),u(D,{label:"\u8054\u7CFB\u7535\u8BDD"},{default:l(()=>[o(d(a.value.orderDelivery.receiverPhone),1)]),_:1}),u(D,{label:"\u6536\u8D27\u5730\u5740",span:2},{default:l(()=>[o(d(a.value.orderDelivery.receiverAddress),1)]),_:1})]),_:1}),a.value.orderDelivery.deliveryInfo?(v(),C("div",Iu,[e[53]||(e[53]=c("h4",null,"\u7269\u6D41\u8F68\u8FF9",-1)),u(du,null,{default:l(()=>[(v(!0),C(h,null,re(JSON.parse(a.value.orderDelivery.deliveryInfo),(t,f)=>(v(),A(su,{key:f,timestamp:t.time,type:f===0?"primary":""},{default:l(()=>[o(d(t.info),1)]),_:2},1032,["timestamp","type"]))),128))]),_:1})])):b("",!0),a.value.status===1||a.value.status===2?(v(),C("div",Ru,[u(m,{type:"primary",onClick:ze},{default:l(()=>e[54]||(e[54]=[o("\u66F4\u65B0\u7269\u6D41\u4FE1\u606F")])),_:1,__:[54]})])):b("",!0)])):b("",!0),a.value.orderRefund?(v(),C("div",Nu,[e[57]||(e[57]=c("h3",null,"\u9000\u6B3E\u4FE1\u606F",-1)),u(Fe,{column:2,border:""},{default:l(()=>[u(D,{label:"\u9000\u6B3E\u5355\u53F7"},{default:l(()=>[o(d(a.value.orderRefund.refundNo),1)]),_:1}),u(D,{label:"\u9000\u6B3E\u91D1\u989D"},{default:l(()=>[o("\xA5"+d(a.value.orderRefund.refundAmount.toFixed(2)),1)]),_:1}),u(D,{label:"\u9000\u6B3E\u539F\u56E0"},{default:l(()=>[o(d(a.value.orderRefund.reason),1)]),_:1}),u(D,{label:"\u9000\u6B3E\u72B6\u6001"},{default:l(()=>[u(Z,{type:$e(a.value.orderRefund.status)},{default:l(()=>[o(d(je(a.value.orderRefund.status)),1)]),_:1},8,["type"])]),_:1}),u(D,{label:"\u7533\u8BF7\u65F6\u95F4"},{default:l(()=>[o(d(a.value.orderRefund.applyTime),1)]),_:1}),u(D,{label:"\u5904\u7406\u65F6\u95F4"},{default:l(()=>[o(d(a.value.orderRefund.handleTime||"\u672A\u5904\u7406"),1)]),_:1}),u(D,{label:"\u9000\u6B3E\u8BF4\u660E",span:2},{default:l(()=>[o(d(a.value.orderRefund.description),1)]),_:1}),a.value.orderRefund.rejectReason?(v(),A(D,{key:0,label:"\u62D2\u7EDD\u539F\u56E0",span:2},{default:l(()=>[o(d(a.value.orderRefund.rejectReason),1)]),_:1})):b("",!0),a.value.orderRefund.proofImages?(v(),A(D,{key:1,label:"\u51ED\u8BC1\u56FE\u7247",span:2},{default:l(()=>[c("div",Uu,[(v(!0),C(h,null,re(JSON.parse(a.value.orderRefund.proofImages),(t,f)=>(v(),A(ke,{key:f,src:t,"preview-src-list":JSON.parse(a.value.orderRefund.proofImages),fit:"cover",class:"proof-image"},{error:l(()=>[c("div",Pu,[u(ae,null,{default:l(()=>[u(S(bu))]),_:1})])]),_:2},1032,["src","preview-src-list"]))),128))])]),_:1})):b("",!0)]),_:1}),a.value.orderRefund.status===0?(v(),C("div",Tu,[u(m,{type:"primary",onClick:e[4]||(e[4]=t=>Ce(a.value))},{default:l(()=>e[56]||(e[56]=[o("\u5904\u7406\u9000\u6B3E")])),_:1,__:[56]})])):b("",!0)])):b("",!0)]),_:1},8,["modelValue"]),u(N,{modelValue:L.value,"onUpdate:modelValue":e[9]||(e[9]=t=>L.value=t),title:"\u8BA2\u5355\u53D1\u8D27",width:"500px"},{footer:l(()=>[c("span",qu,[u(m,{onClick:e[8]||(e[8]=t=>L.value=!1)},{default:l(()=>e[58]||(e[58]=[o("\u53D6\u6D88")])),_:1,__:[58]}),u(m,{type:"primary",onClick:Je},{default:l(()=>e[59]||(e[59]=[o("\u786E\u5B9A")])),_:1,__:[59]})])]),default:l(()=>[u(T,{ref_key:"deliveryFormRef",ref:de,model:w,rules:Ne,"label-width":"100px"},{default:l(()=>[u(s,{label:"\u7269\u6D41\u516C\u53F8",prop:"deliveryCompany"},{default:l(()=>[u(n,{modelValue:w.deliveryCompany,"onUpdate:modelValue":e[6]||(e[6]=t=>w.deliveryCompany=t),placeholder:"\u8BF7\u8F93\u5165\u7269\u6D41\u516C\u53F8"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u7269\u6D41\u5355\u53F7",prop:"deliverySn"},{default:l(()=>[u(n,{modelValue:w.deliverySn,"onUpdate:modelValue":e[7]||(e[7]=t=>w.deliverySn=t),placeholder:"\u8BF7\u8F93\u5165\u7269\u6D41\u5355\u53F7"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),u(N,{modelValue:U.value,"onUpdate:modelValue":e[17]||(e[17]=t=>U.value=t),title:a.value.orderRefund?"\u5904\u7406\u9000\u6B3E":"\u7533\u8BF7\u9000\u6B3E",width:"500px"},{footer:l(()=>[c("span",zu,[u(m,{onClick:e[16]||(e[16]=t=>U.value=!1)},{default:l(()=>e[63]||(e[63]=[o("\u53D6\u6D88")])),_:1,__:[63]}),u(m,{type:"primary",onClick:Ge},{default:l(()=>e[64]||(e[64]=[o("\u63D0\u4EA4")])),_:1,__:[64]})])]),default:l(()=>[u(T,{ref_key:"refundFormRef",ref:ne,model:p,rules:Ue,"label-width":"100px"},{default:l(()=>[a.value.orderRefund?(v(),C(h,{key:0},[u(s,{label:"\u9000\u6B3E\u5355\u53F7"},{default:l(()=>[o(d(a.value.orderRefund.refundNo),1)]),_:1}),u(s,{label:"\u9000\u6B3E\u91D1\u989D"},{default:l(()=>[o("\xA5"+d(a.value.orderRefund.refundAmount.toFixed(2)),1)]),_:1}),u(s,{label:"\u9000\u6B3E\u539F\u56E0"},{default:l(()=>[o(d(a.value.orderRefund.reason),1)]),_:1}),u(s,{label:"\u9000\u6B3E\u8BF4\u660E"},{default:l(()=>[o(d(a.value.orderRefund.description),1)]),_:1}),u(s,{label:"\u7533\u8BF7\u65F6\u95F4"},{default:l(()=>[o(d(a.value.orderRefund.applyTime),1)]),_:1}),u(s,{label:"\u5904\u7406\u7ED3\u679C",prop:"status"},{default:l(()=>[u(nu,{modelValue:p.status,"onUpdate:modelValue":e[10]||(e[10]=t=>p.status=t)},{default:l(()=>[u(Se,{label:1},{default:l(()=>e[60]||(e[60]=[o("\u540C\u610F\u9000\u6B3E")])),_:1,__:[60]}),u(Se,{label:2},{default:l(()=>e[61]||(e[61]=[o("\u62D2\u7EDD\u9000\u6B3E")])),_:1,__:[61]})]),_:1},8,["modelValue"])]),_:1}),p.status===2?(v(),A(s,{key:0,label:"\u62D2\u7EDD\u539F\u56E0",prop:"rejectReason"},{default:l(()=>[u(n,{modelValue:p.rejectReason,"onUpdate:modelValue":e[11]||(e[11]=t=>p.rejectReason=t),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u62D2\u7EDD\u539F\u56E0"},null,8,["modelValue"])]),_:1})):b("",!0)],64)):(v(),C(h,{key:1},[u(s,{label:"\u9000\u6B3E\u91D1\u989D",prop:"refundAmount"},{default:l(()=>[u(ce,{modelValue:p.refundAmount,"onUpdate:modelValue":e[12]||(e[12]=t=>p.refundAmount=t),min:0,max:a.value.totalAmount,precision:2,step:.01},null,8,["modelValue","max"])]),_:1}),u(s,{label:"\u9000\u6B3E\u539F\u56E0",prop:"reason"},{default:l(()=>[u(n,{modelValue:p.reason,"onUpdate:modelValue":e[13]||(e[13]=t=>p.reason=t),placeholder:"\u8BF7\u8F93\u5165\u9000\u6B3E\u539F\u56E0"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u9000\u6B3E\u8BF4\u660E",prop:"description"},{default:l(()=>[u(n,{modelValue:p.description,"onUpdate:modelValue":e[14]||(e[14]=t=>p.description=t),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u9000\u6B3E\u8BF4\u660E"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u51ED\u8BC1\u56FE\u7247",prop:"proofImages"},{default:l(()=>[u(iu,{action:"#","list-type":"picture-card","auto-upload":!1,"on-change":async t=>{try{const f=await S(Vu)(t.raw);if(f.data){const k=JSON.parse(p.proofImages);k.push(f.data),p.proofImages=JSON.stringify(k),S(g).success("\u56FE\u7247\u4E0A\u4F20\u6210\u529F")}}catch(f){console.error("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25:",f),S(g).error("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25")}},"on-remove":t=>{const f=JSON.parse(p.proofImages),k=f.indexOf(t.url);k>-1&&(f.splice(k,1),p.proofImages=JSON.stringify(f))},"on-preview":t=>{ye.value.value=t.url,ie.value.value=!0},"before-upload":t=>{const f=t.type.startsWith("image/"),k=t.size/1024/1024<5;return f?k?!0:(S(g).error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 5MB\uFF01"),!1):(S(g).error("\u53EA\u80FD\u4E0A\u4F20\u56FE\u7247\u6587\u4EF6\uFF01"),!1)},limit:5,"on-exceed":()=>{S(g).warning("\u6700\u591A\u53EA\u80FD\u4E0A\u4F205\u5F20\u56FE\u7247")}},{tip:l(()=>e[62]||(e[62]=[c("div",{class:"el-upload__tip"}," \u652F\u6301jpg\u3001png\u3001jpeg\u683C\u5F0F\uFF0C\u5355\u5F20\u56FE\u7247\u4E0D\u8D85\u8FC75MB\uFF0C\u6700\u591A\u4E0A\u4F205\u5F20 ",-1)])),default:l(()=>[u(ae,null,{default:l(()=>[u(S(Re))]),_:1})]),_:1},8,["on-change","on-remove","on-preview","before-upload","on-exceed"]),u(N,{modelValue:ie.value,"onUpdate:modelValue":e[15]||(e[15]=t=>ie.value=t),title:"\u9884\u89C8"},{default:l(()=>[c("img",{src:ye.value,alt:"Preview",style:{width:"100%"}},null,8,Ou)]),_:1},8,["modelValue"])]),_:1})],64))]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),u(N,{modelValue:J.value,"onUpdate:modelValue":e[26]||(e[26]=t=>J.value=t),title:"\u521B\u5EFA\u8BA2\u5355",width:"800px"},{footer:l(()=>[c("span",Wu,[u(m,{onClick:e[25]||(e[25]=t=>J.value=!1)},{default:l(()=>e[66]||(e[66]=[o("\u53D6\u6D88")])),_:1,__:[66]}),u(m,{type:"primary",onClick:ou},{default:l(()=>e[67]||(e[67]=[o("\u786E\u5B9A")])),_:1,__:[67]})])]),default:l(()=>[u(T,{ref_key:"createFormRef",ref:pe,model:i,rules:Pe,"label-width":"100px"},{default:l(()=>[u(s,{label:"\u7528\u6237ID",prop:"userId"},{default:l(()=>[u(n,{modelValue:i.userId,"onUpdate:modelValue":e[18]||(e[18]=t=>i.userId=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237ID"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u652F\u4ED8\u65B9\u5F0F",prop:"payType"},{default:l(()=>[u(Y,{modelValue:i.payType,"onUpdate:modelValue":e[19]||(e[19]=t=>i.payType=t),placeholder:"\u8BF7\u9009\u62E9\u652F\u4ED8\u65B9\u5F0F"},{default:l(()=>[u(E,{label:"\u652F\u4ED8\u5B9D",value:1}),u(E,{label:"\u5FAE\u4FE1",value:2}),u(E,{label:"\u94F6\u8054",value:3})]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"\u6536\u8D27\u4EBA",prop:"receiverName"},{default:l(()=>[u(n,{modelValue:i.receiverName,"onUpdate:modelValue":e[20]||(e[20]=t=>i.receiverName=t),placeholder:"\u8BF7\u8F93\u5165\u6536\u8D27\u4EBA\u59D3\u540D"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u8054\u7CFB\u7535\u8BDD",prop:"receiverPhone"},{default:l(()=>[u(n,{modelValue:i.receiverPhone,"onUpdate:modelValue":e[21]||(e[21]=t=>i.receiverPhone=t),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u6536\u8D27\u5730\u5740",prop:"receiverAddress"},{default:l(()=>[u(n,{modelValue:i.receiverAddress,"onUpdate:modelValue":e[22]||(e[22]=t=>i.receiverAddress=t),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u6536\u8D27\u5730\u5740"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u8FD0\u8D39",prop:"freightAmount"},{default:l(()=>[u(ce,{modelValue:i.freightAmount,"onUpdate:modelValue":e[23]||(e[23]=t=>i.freightAmount=t),min:0,precision:2,step:.01,onChange:te},null,8,["modelValue"])]),_:1}),u(s,{label:"\u8BA2\u5355\u5907\u6CE8",prop:"note"},{default:l(()=>[u(n,{modelValue:i.note,"onUpdate:modelValue":e[24]||(e[24]=t=>i.note=t),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u5546\u54C1\u4FE1\u606F",prop:"orderItems"},{default:l(()=>[c("div",hu,[(v(!0),C(h,null,re(i.orderItems,(t,f)=>(v(),C("div",{key:f,class:"order-item"},[u(pu,{gutter:20,align:"middle"},{default:l(()=>[u(q,{span:4},{default:l(()=>[u(ke,{src:t.productPic,"preview-src-list":[t.productPic],fit:"cover",class:"product-image"},null,8,["src","preview-src-list"])]),_:2},1024),u(q,{span:6},{default:l(()=>[c("div",Mu,[c("div",$u,d(t.productName),1),t.skuName?(v(),C("div",ju,d(t.skuName),1)):b("",!0)])]),_:2},1024),u(q,{span:4},{default:l(()=>[c("div",Lu,"\xA5"+d(t.price.toFixed(2)),1)]),_:2},1024),u(q,{span:4},{default:l(()=>[u(ce,{modelValue:t.quantity,"onUpdate:modelValue":k=>t.quantity=k,min:1,step:1,onChange:()=>au(f),class:"quantity-input"},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),u(q,{span:4},{default:l(()=>[c("div",Ju,"\xA5"+d(t.totalAmount.toFixed(2)),1)]),_:2},1024),u(q,{span:2},{default:l(()=>[u(m,{type:"danger",link:"",onClick:k=>ru(f)},{default:l(()=>[u(ae,null,{default:l(()=>[u(S(Au))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),u(m,{type:"primary",link:"",onClick:uu,class:"add-product-btn"},{default:l(()=>[u(ae,null,{default:l(()=>[u(S(Re))]),_:1}),e[65]||(e[65]=o("\u6DFB\u52A0\u5546\u54C1 "))]),_:1,__:[65]})])]),_:1}),u(s,{label:"\u8BA2\u5355\u603B\u91D1\u989D"},{default:l(()=>[c("span",Hu,"\xA5"+d(i.totalAmount.toFixed(2)),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),u(N,{modelValue:H.value,"onUpdate:modelValue":e[32]||(e[32]=t=>H.value=t),title:"\u9009\u62E9\u5546\u54C1",width:"800px"},{default:l(()=>[c("div",Gu,[u(T,{inline:!0,model:V},{default:l(()=>[u(s,{label:"\u5546\u54C1\u540D\u79F0"},{default:l(()=>[u(n,{modelValue:V.name,"onUpdate:modelValue":e[27]||(e[27]=t=>V.name=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),u(s,{label:"\u5546\u54C1\u72B6\u6001"},{default:l(()=>[u(Y,{modelValue:V.status,"onUpdate:modelValue":e[28]||(e[28]=t=>V.status=t),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",clearable:""},{default:l(()=>[u(E,{label:"\u4E0A\u67B6",value:1}),u(E,{label:"\u4E0B\u67B6",value:0})]),_:1},8,["modelValue"])]),_:1}),u(s,null,{default:l(()=>[u(m,{type:"primary",onClick:be},{default:l(()=>e[68]||(e[68]=[o("\u641C\u7D22")])),_:1,__:[68]}),u(m,{onClick:e[29]||(e[29]=()=>{V.name="",V.status="",be()})},{default:l(()=>e[69]||(e[69]=[o("\u91CD\u7F6E")])),_:1,__:[69]})]),_:1})]),_:1},8,["model"])]),Ie((v(),A(fe,{data:W.value,border:"",style:{width:"100%"}},{default:l(()=>[u(B,{prop:"name",label:"\u5546\u54C1\u540D\u79F0"}),u(B,{prop:"price",label:"\u4EF7\u683C",width:"120"},{default:l(({row:t})=>[o(" \xA5"+d(t.price.toFixed(2)),1)]),_:1}),u(B,{prop:"stock",label:"\u5E93\u5B58",width:"100"}),u(B,{prop:"status",label:"\u72B6\u6001",width:"100"},{default:l(({row:t})=>[u(Z,{type:t.status===1?"success":"info"},{default:l(()=>[o(d(t.status===1?"\u4E0A\u67B6":"\u4E0B\u67B6"),1)]),_:2},1032,["type"])]),_:1}),u(B,{label:"\u64CD\u4F5C",width:"100",fixed:"right"},{default:l(({row:t})=>[u(m,{type:"primary",link:"",onClick:f=>Ze(t)},{default:l(()=>e[70]||(e[70]=[o("\u9009\u62E9")])),_:2,__:[70]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[we,ve.value]]),c("div",Ku,[u(Ve,{"current-page":P.value,"onUpdate:currentPage":e[30]||(e[30]=t=>P.value=t),"page-size":ue.value,"onUpdate:pageSize":e[31]||(e[31]=t=>ue.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:G.value,onSizeChange:lu,onCurrentChange:tu},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),u(N,{modelValue:K.value,"onUpdate:modelValue":e[35]||(e[35]=t=>K.value=t),title:"\u9009\u62E9\u89C4\u683C",width:"500px"},{footer:l(()=>[c("span",Xu,[u(m,{onClick:e[34]||(e[34]=t=>K.value=!1)},{default:l(()=>e[72]||(e[72]=[o("\u53D6\u6D88")])),_:1,__:[72]}),u(m,{type:"primary",onClick:eu},{default:l(()=>e[73]||(e[73]=[o("\u786E\u5B9A")])),_:1,__:[73]})])]),default:l(()=>[R.value?(v(),C("div",Qu,[e[71]||(e[71]=c("p",null,"\u8BF7\u9009\u62E9\u5546\u54C1\u89C4\u683C:",-1)),u(Y,{modelValue:Q.value,"onUpdate:modelValue":e[33]||(e[33]=t=>Q.value=t),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u89C4\u683C"},{default:l(()=>[(v(!0),C(h,null,re(R.value.skuList,t=>(v(),A(E,{key:t.id,label:`${t.name} (\xA5${t.price.toFixed(2)})`,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):b("",!0)]),_:1},8,["modelValue"]),u(N,{modelValue:X.value,"onUpdate:modelValue":e[41]||(e[41]=t=>X.value=t),title:"\u66F4\u65B0\u7269\u6D41\u4FE1\u606F",width:"500px"},{footer:l(()=>[c("span",Yu,[u(m,{onClick:e[40]||(e[40]=t=>X.value=!1)},{default:l(()=>e[74]||(e[74]=[o("\u53D6\u6D88")])),_:1,__:[74]}),u(m,{type:"primary",onClick:he},{default:l(()=>e[75]||(e[75]=[o("\u786E\u5B9A")])),_:1,__:[75]})])]),default:l(()=>[u(T,{ref_key:"updateDeliveryFormRef",ref:me,model:_,rules:Oe,"label-width":"100px"},{default:l(()=>[u(s,{label:"\u7269\u6D41\u516C\u53F8",prop:"deliveryCompany"},{default:l(()=>[u(n,{modelValue:_.deliveryCompany,"onUpdate:modelValue":e[36]||(e[36]=t=>_.deliveryCompany=t),placeholder:"\u8BF7\u8F93\u5165\u7269\u6D41\u516C\u53F8"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u7269\u6D41\u5355\u53F7",prop:"deliverySn"},{default:l(()=>[u(n,{modelValue:_.deliverySn,"onUpdate:modelValue":e[37]||(e[37]=t=>_.deliverySn=t),placeholder:"\u8BF7\u8F93\u5165\u7269\u6D41\u5355\u53F7"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u7269\u6D41\u72B6\u6001",prop:"status"},{default:l(()=>[u(Y,{modelValue:_.status,"onUpdate:modelValue":e[38]||(e[38]=t=>_.status=t),placeholder:"\u8BF7\u9009\u62E9\u7269\u6D41\u72B6\u6001"},{default:l(()=>[u(E,{label:"\u5F85\u53D1\u8D27",value:0}),u(E,{label:"\u5DF2\u53D1\u8D27",value:1}),u(E,{label:"\u5DF2\u7B7E\u6536",value:2})]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"\u7269\u6D41\u4FE1\u606F",prop:"deliveryInfo"},{default:l(()=>[u(n,{modelValue:_.deliveryInfo,"onUpdate:modelValue":e[39]||(e[39]=t=>_.deliveryInfo=t),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u7269\u6D41\u4FE1\u606F"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});var rl=_u(Zu,[["__scopeId","data-v-54c9b21f"]]);export{rl as default};
