import{g as K,d as O,u as z,c as Q}from"./product.4ae09d3b.js";import{_ as W,d as X,r as n,y as S,o as Y,b as o,H as Z,e as A,f as ee,i as b,g as u,h as s,j as r,I as ue,m as te,t as ae,J as le,E as F}from"./index.2cc8de7c.js";const se={class:"category-container"},oe={class:"header"},ne={class:"pagination"},re={class:"dialog-footer"},ie=X({__name:"index",setup(de){const D=n(!1),C=n([]),d=n(1),_=n(10),B=n(0),p=n(!1),y=n("add"),V=n(),l=S({id:"",name:"",description:"",sort:0,status:1}),U={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0",trigger:"blur"},{min:2,max:50,message:"\u957F\u5EA6\u5728 2 \u5230 50 \u4E2A\u5B57\u7B26",trigger:"blur"}],description:[{max:200,message:"\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7 200 \u4E2A\u5B57\u7B26",trigger:"blur"}],sort:[{required:!0,message:"\u8BF7\u8F93\u5165\u6392\u5E8F\u53F7",trigger:"blur"}]},v=S({name:""}),m=async()=>{D.value=!0;try{const t={size:_.value,page:d.value,name:v.name},e=await K(t);e.success&&e.data?(C.value=e.data.records||[],B.value=e.data.total||0,d.value=e.data.current||1,_.value=e.data.size||10):(C.value=[],B.value=0)}catch(t){console.error("\u83B7\u53D6\u5206\u7C7B\u5217\u8868\u5931\u8D25:",t),C.value=[],B.value=0}finally{D.value=!1}},w=()=>{y.value="add",l.id="",l.name="",l.description="",l.sort=0,l.status=1,p.value=!0},I=t=>{y.value="edit",l.id=t.id,l.name=t.name,l.description=t.description,l.sort=t.sort,l.status=t.status,p.value=!0},M=t=>{le.confirm("\u786E\u8BA4\u5220\u9664\u8BE5\u5206\u7C7B\u5417\uFF1F","\u63D0\u793A",{type:"warning"}).then(async()=>{try{await O(t.id),F.success("\u5220\u9664\u6210\u529F"),m()}catch(e){console.error("\u5220\u9664\u5206\u7C7B\u5931\u8D25:",e)}})},N=async t=>{const e=t.status===1?0:1;t.status=e;try{await z(t.id,{...t,status:e}),F.success("\u72B6\u6001\u66F4\u65B0\u6210\u529F")}catch(g){console.error("\u66F4\u65B0\u5206\u7C7B\u72B6\u6001\u5931\u8D25:",g),t.status=t.status===1?0:1,F.error("\u72B6\u6001\u66F4\u65B0\u5931\u8D25")}},$=async()=>{!V.value||await V.value.validate(async t=>{if(t)try{y.value==="add"?(await Q(l),F.success("\u65B0\u589E\u6210\u529F")):(await z(l.id,l),F.success("\u66F4\u65B0\u6210\u529F")),p.value=!1,m()}catch(e){console.error("\u63D0\u4EA4\u5931\u8D25:",e)}})},j=t=>{_.value=t,m()},q=t=>{d.value=t,m()},E=()=>{d.value=1,m()},L=()=>{v.name="",E()};return Y(()=>{m()}),(t,e)=>{const g=o("el-input"),c=o("el-form-item"),i=o("el-button"),x=o("el-form"),f=o("el-table-column"),P=o("el-tag"),k=o("el-switch"),R=o("el-table"),T=o("el-pagination"),H=o("el-input-number"),J=o("el-dialog"),G=Z("loading");return A(),ee("div",se,[b("div",oe,[u(x,{inline:!0,model:v,class:"search-form"},{default:s(()=>[u(c,{label:"\u5206\u7C7B\u540D\u79F0"},{default:s(()=>[u(g,{modelValue:v.name,"onUpdate:modelValue":e[0]||(e[0]=a=>v.name=a),placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),u(c,null,{default:s(()=>[u(i,{type:"primary",onClick:E},{default:s(()=>e[9]||(e[9]=[r("\u641C\u7D22")])),_:1,__:[9]}),u(i,{onClick:L},{default:s(()=>e[10]||(e[10]=[r("\u91CD\u7F6E")])),_:1,__:[10]}),u(i,{type:"success",onClick:w},{default:s(()=>e[11]||(e[11]=[b("i",{class:"sfont system-add"},null,-1),r("\u65B0\u589E\u5206\u7C7B ")])),_:1,__:[11]})]),_:1})]),_:1},8,["model"])]),ue((A(),te(R,{data:C.value,border:"",style:{width:"100%"}},{default:s(()=>[u(f,{prop:"id",label:"ID",width:"80"}),u(f,{prop:"name",label:"\u5206\u7C7B\u540D\u79F0"}),u(f,{prop:"description",label:"\u63CF\u8FF0","show-overflow-tooltip":""}),u(f,{prop:"status",label:"\u72B6\u6001",width:"100"},{default:s(({row:a})=>[u(P,{type:a.status===1?"success":"danger",size:"small"},{default:s(()=>[r(ae(a.status===1?"\u542F\u7528":"\u7981\u7528"),1)]),_:2},1032,["type"]),u(k,{"model-value":a.status,"active-value":1,"inactive-value":0,onChange:h=>N(a),style:{"margin-left":"8px"}},null,8,["model-value","onChange"])]),_:1}),u(f,{label:"\u64CD\u4F5C",width:"200",fixed:"right"},{default:s(({row:a})=>[u(i,{type:"primary",link:"",onClick:h=>I(a)},{default:s(()=>e[12]||(e[12]=[r("\u7F16\u8F91")])),_:2,__:[12]},1032,["onClick"]),u(i,{type:"danger",link:"",onClick:h=>M(a)},{default:s(()=>e[13]||(e[13]=[r("\u5220\u9664")])),_:2,__:[13]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,D.value]]),b("div",ne,[u(T,{"current-page":d.value,"onUpdate:currentPage":e[1]||(e[1]=a=>d.value=a),"page-size":_.value,"onUpdate:pageSize":e[2]||(e[2]=a=>_.value=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:B.value,onSizeChange:j,onCurrentChange:q},null,8,["current-page","page-size","total"])]),u(J,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=a=>p.value=a),title:y.value==="add"?"\u65B0\u589E\u5206\u7C7B":"\u7F16\u8F91\u5206\u7C7B",width:"500px"},{footer:s(()=>[b("span",re,[u(i,{onClick:e[7]||(e[7]=a=>p.value=!1)},{default:s(()=>e[14]||(e[14]=[r("\u53D6\u6D88")])),_:1,__:[14]}),u(i,{type:"primary",onClick:$},{default:s(()=>e[15]||(e[15]=[r("\u786E\u5B9A")])),_:1,__:[15]})])]),default:s(()=>[u(x,{ref_key:"formRef",ref:V,model:l,rules:U,"label-width":"100px"},{default:s(()=>[u(c,{label:"\u5206\u7C7B\u540D\u79F0",prop:"name"},{default:s(()=>[u(g,{modelValue:l.name,"onUpdate:modelValue":e[3]||(e[3]=a=>l.name=a),placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0"},null,8,["modelValue"])]),_:1}),u(c,{label:"\u5206\u7C7B\u63CF\u8FF0",prop:"description"},{default:s(()=>[u(g,{modelValue:l.description,"onUpdate:modelValue":e[4]||(e[4]=a=>l.description=a),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u63CF\u8FF0"},null,8,["modelValue"])]),_:1}),u(c,{label:"\u6392\u5E8F\u53F7",prop:"sort"},{default:s(()=>[u(H,{modelValue:l.sort,"onUpdate:modelValue":e[5]||(e[5]=a=>l.sort=a),min:0,max:999},null,8,["modelValue"])]),_:1}),u(c,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[u(k,{modelValue:l.status,"onUpdate:modelValue":e[6]||(e[6]=a=>l.status=a),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});var ce=W(ie,[["__scopeId","data-v-089b5262"]]);export{ce as default};
