(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-confirm-index"],{3332:function(t,e,o){"use strict";o("6a54");var i=o("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(o("2634")),a=i(o("2fdc"));o("473f"),o("bf0f"),o("e838"),o("d4b5"),o("fd3c"),o("2797");var s=o("c68b"),r={data:function(){return{info:{name:null,phone:null,address:null},isDirect:!1,goodsList:[],remark:"",deliveryFee:0}},computed:{goodsAmount:function(){return this.goodsList.reduce((function(t,e){return t+e.price*e.quantity}),0).toFixed(2)},totalAmount:function(){return(parseFloat(this.goodsAmount)+parseFloat(this.deliveryFee)).toFixed(2)}},onLoad:function(t){this.isDirect="1"===t.direct,this.getGoodsList()},methods:{getGoodsList:function(){if(this.isDirect){var t=uni.getStorageSync("buyNowGoods");t&&(this.goodsList=[t])}else{var e=this.$store.getters.checkedCartList;this.goodsList=JSON.parse(JSON.stringify(e))}},submitOrder:function(){var t=this;return(0,a.default)((0,n.default)().mark((function e(){var o,i;return(0,n.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,uni.showLoading({title:"提交中..."}),o={userId:t.$store.state.userInfo.id,totalAmount:parseFloat(t.goodsAmount),payAmount:parseFloat(t.totalAmount),freightAmount:parseFloat(t.deliveryFee),payType:1,receiverName:t.info.name,receiverPhone:t.info.phone,receiverAddress:t.info.address,note:t.remark,orderItems:t.goodsList.map((function(t){return{productId:t.id,skuId:t.skuId||null,productName:t.name,skuName:t.skuName||"",productPic:t.mainImage,price:t.price,quantity:t.quantity,totalAmount:t.price*t.quantity}}))},e.next=5,(0,s.createOrder)(o);case 5:i=e.sent,uni.hideLoading(),i&&i.data&&(t.isDirect||t.goodsList.forEach((function(e){t.$store.commit("removeFromCart",e.id)})),uni.removeStorageSync("buyNowGoods"),uni.showToast({title:"订单提交成功",icon:"success",duration:2e3}),setTimeout((function(){uni.navigateTo({url:"/pages/order-list/index"})}),1500)),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),uni.hideLoading(),console.error("提交订单失败",e.t0),uni.showToast({title:"提交订单失败",icon:"none"});case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))()}}};e.default=r},"4d7d":function(t,e,o){"use strict";o.r(e);var i=o("3332"),n=o.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(a);e["default"]=n.a},"60e8":function(t,e,o){"use strict";o.r(e);var i=o("82a1"),n=o("4d7d");for(var a in n)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(a);o("ef9f");var s=o("828b"),r=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"0395d3e4",null,!1,i["a"],void 0);e["default"]=r.exports},"78d9":function(t,e,o){var i=o("e1a3");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=o("967d").default;n("34b3506a",i,!0,{sourceMap:!1,shadowMode:!1})},"82a1":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return n})),o.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"confirm-container"},[o("v-uni-view",{staticClass:"address-box",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseAddress.apply(void 0,arguments)}}},[t.address?o("v-uni-view",{staticClass:"address-info"}):o("v-uni-view",{staticClass:"no-address"},[o("v-uni-input",{attrs:{placeholder:"请填写收货地址"},model:{value:t.info.address,callback:function(e){t.$set(t.info,"address",e)},expression:"info.address"}}),o("hr"),o("br"),o("v-uni-input",{attrs:{placeholder:"请填写收货人"},model:{value:t.info.name,callback:function(e){t.$set(t.info,"name",e)},expression:"info.name"}}),o("hr"),o("br"),o("v-uni-input",{attrs:{placeholder:"请填写电话"},model:{value:t.info.phone,callback:function(e){t.$set(t.info,"phone",e)},expression:"info.phone"}}),o("hr"),o("br")],1),o("v-uni-text",{staticClass:"iconfont icon-right"})],1),o("v-uni-view",{staticClass:"goods-box"},[o("v-uni-view",{staticClass:"goods-title"},[o("v-uni-text",[t._v("商品清单")])],1),o("v-uni-view",{staticClass:"goods-list"},t._l(t.goodsList,(function(e,i){return o("v-uni-view",{key:i,staticClass:"goods-item"},[o("v-uni-image",{staticClass:"goods-image",attrs:{src:e.mainImage,mode:"aspectFill"}}),o("v-uni-view",{staticClass:"goods-info"},[o("v-uni-text",{staticClass:"goods-name text-ellipsis-2"},[t._v(t._s(e.name))]),e.skuName?o("v-uni-text",{staticClass:"goods-sku"},[t._v("规格："+t._s(e.skuName))]):t._e(),o("v-uni-view",{staticClass:"goods-price-box"},[o("v-uni-text",{staticClass:"goods-price"},[t._v("¥"+t._s(e.price))]),o("v-uni-text",{staticClass:"goods-quantity"},[t._v("x"+t._s(e.quantity))])],1)],1)],1)})),1)],1),o("v-uni-view",{staticClass:"delivery-box"},[o("v-uni-view",{staticClass:"delivery-title"},[o("v-uni-text",[t._v("配送方式")])],1),o("v-uni-view",{staticClass:"delivery-content"},[o("v-uni-text",[t._v("快递配送")]),o("v-uni-text",{staticClass:"delivery-fee"},[t._v("¥"+t._s(t.deliveryFee))])],1)],1),o("v-uni-view",{staticClass:"remark-box"},[o("v-uni-view",{staticClass:"remark-title"},[o("v-uni-text",[t._v("订单备注")])],1),o("v-uni-view",{staticClass:"remark-content"},[o("v-uni-input",{staticClass:"remark-input",attrs:{type:"text",placeholder:"选填，请先和商家协商一致"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1)],1),o("v-uni-view",{staticClass:"amount-box"},[o("v-uni-view",{staticClass:"amount-item"},[o("v-uni-text",[t._v("商品金额")]),o("v-uni-text",[t._v("¥"+t._s(t.goodsAmount))])],1),o("v-uni-view",{staticClass:"amount-item"},[o("v-uni-text",[t._v("运费")]),o("v-uni-text",[t._v("¥"+t._s(t.deliveryFee))])],1),o("v-uni-view",{staticClass:"amount-total"},[o("v-uni-text",[t._v("实付金额")]),o("v-uni-text",{staticClass:"total-price"},[t._v("¥"+t._s(t.totalAmount))])],1)],1),o("v-uni-view",{staticClass:"settlement-bar"},[o("v-uni-view",{staticClass:"total-box"},[o("v-uni-text",[t._v("合计：")]),o("v-uni-text",{staticClass:"total-price"},[t._v("¥"+t._s(t.totalAmount))])],1),o("v-uni-view",{staticClass:"submit-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitOrder.apply(void 0,arguments)}}},[t._v("提交订单")])],1)],1)},n=[]},c68b:function(t,e,o){"use strict";o("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.updateOrderStatus=e.getOrderList=e.getOrderDetail=e.createOrder=void 0,o("c223");var i=o("a8e1");e.createOrder=function(t){return(0,i.post)("/orders",t)};e.getOrderList=function(t){return(0,i.get)("/orders/page",t)};e.getOrderDetail=function(t){return(0,i.get)("/orders/".concat(t))};e.updateOrderStatus=function(t,e){return(0,i.put)("/orders/".concat(t,"/status?status=").concat(e))}},e1a3:function(t,e,o){var i=o("c86c");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/* 主题颜色 */\n/* 文字颜色 */\n/* 边框颜色 */\n/* 背景颜色 */\n/* 字体大小 */\n/* 间距 */\n/* 圆角 */\n/* 阴影 */.confirm-container[data-v-0395d3e4]{min-height:100vh;background-color:#f5f5f5;padding-bottom:%?120?%}.confirm-container .address-box[data-v-0395d3e4]{background-color:#fff;padding:%?30?%;margin-bottom:%?20?%;display:flex;align-items:center;position:relative}.confirm-container .address-box .address-info[data-v-0395d3e4]{flex:1}.confirm-container .address-box .address-info .user-info[data-v-0395d3e4]{margin-bottom:%?10?%}.confirm-container .address-box .address-info .user-info .name[data-v-0395d3e4]{font-size:%?32?%;color:#303133;font-weight:700;margin-right:%?20?%}.confirm-container .address-box .address-info .user-info .phone[data-v-0395d3e4]{font-size:%?28?%;color:#606266}.confirm-container .address-box .address-info .address-detail[data-v-0395d3e4]{font-size:%?28?%;color:#606266;line-height:1.4}.confirm-container .address-box .no-address[data-v-0395d3e4]{flex:1;font-size:%?32?%;color:#606266}.confirm-container .address-box .iconfont[data-v-0395d3e4]{font-size:%?40?%;color:#909399;margin-left:%?20?%}.confirm-container .address-box[data-v-0395d3e4]::after{content:"";position:absolute;left:0;right:0;bottom:0;height:%?6?%;background-image:linear-gradient(45deg,#ff6700 25%,transparent 0,transparent 50%,#ff6700 0,#ff6700 75%,transparent 0,transparent);background-size:%?20?% %?20?%}.confirm-container .goods-box[data-v-0395d3e4]{background-color:#fff;margin-bottom:%?20?%}.confirm-container .goods-box .goods-title[data-v-0395d3e4]{padding:%?30?%;border-bottom:%?1?% solid #ebeef5;font-size:%?32?%;color:#303133;font-weight:700}.confirm-container .goods-box .goods-list .goods-item[data-v-0395d3e4]{display:flex;padding:%?30?%;border-bottom:%?1?% solid #ebeef5}.confirm-container .goods-box .goods-list .goods-item .goods-image[data-v-0395d3e4]{width:%?160?%;height:%?160?%;border-radius:%?8?%;margin-right:%?20?%}.confirm-container .goods-box .goods-list .goods-item .goods-info[data-v-0395d3e4]{flex:1;display:flex;flex-direction:column;justify-content:space-between}.confirm-container .goods-box .goods-list .goods-item .goods-info .goods-name[data-v-0395d3e4]{font-size:%?28?%;color:#303133;line-height:1.4;height:2.8em}.confirm-container .goods-box .goods-list .goods-item .goods-info .goods-sku[data-v-0395d3e4]{font-size:%?24?%;color:#909399;margin-top:%?10?%}.confirm-container .goods-box .goods-list .goods-item .goods-info .goods-price-box[data-v-0395d3e4]{display:flex;justify-content:space-between;align-items:center}.confirm-container .goods-box .goods-list .goods-item .goods-info .goods-price-box .goods-price[data-v-0395d3e4]{font-size:%?32?%;color:#ff6700;font-weight:700}.confirm-container .goods-box .goods-list .goods-item .goods-info .goods-price-box .goods-quantity[data-v-0395d3e4]{font-size:%?28?%;color:#909399}.confirm-container .delivery-box[data-v-0395d3e4]{background-color:#fff;padding:%?30?%;margin-bottom:%?20?%}.confirm-container .delivery-box .delivery-title[data-v-0395d3e4]{font-size:%?32?%;color:#303133;font-weight:700;margin-bottom:%?20?%}.confirm-container .delivery-box .delivery-content[data-v-0395d3e4]{display:flex;justify-content:space-between;align-items:center;font-size:%?28?%;color:#606266}.confirm-container .delivery-box .delivery-content .delivery-fee[data-v-0395d3e4]{color:#ff6700}.confirm-container .remark-box[data-v-0395d3e4]{background-color:#fff;padding:%?30?%;margin-bottom:%?20?%}.confirm-container .remark-box .remark-title[data-v-0395d3e4]{font-size:%?32?%;color:#303133;font-weight:700;margin-bottom:%?20?%}.confirm-container .remark-box .remark-content .remark-input[data-v-0395d3e4]{width:100%;height:%?80?%;border:%?1?% solid #dcdfe6;border-radius:%?8?%;padding:0 %?20?%;font-size:%?28?%}.confirm-container .amount-box[data-v-0395d3e4]{background-color:#fff;padding:%?30?%}.confirm-container .amount-box .amount-item[data-v-0395d3e4]{display:flex;justify-content:space-between;align-items:center;margin-bottom:%?20?%;font-size:%?28?%;color:#606266}.confirm-container .amount-box .amount-total[data-v-0395d3e4]{display:flex;justify-content:space-between;align-items:center;font-size:%?32?%;color:#303133;padding-top:%?20?%;border-top:%?1?% solid #ebeef5}.confirm-container .amount-box .amount-total .total-price[data-v-0395d3e4]{color:#ff6700;font-weight:700;font-size:%?36?%}.confirm-container .settlement-bar[data-v-0395d3e4]{position:fixed;left:0;right:0;bottom:0;height:%?100?%;background-color:#fff;display:flex;align-items:center;padding-left:%?30?%;box-shadow:0 %?-2?% %?10?% rgba(0,0,0,.05)}.confirm-container .settlement-bar .total-box[data-v-0395d3e4]{flex:1;font-size:%?32?%;color:#303133}.confirm-container .settlement-bar .total-box .total-price[data-v-0395d3e4]{color:#ff6700;font-weight:700;font-size:%?36?%}.confirm-container .settlement-bar .submit-btn[data-v-0395d3e4]{width:%?240?%;height:%?100?%;background-color:#ff6700;color:#fff;font-size:%?32?%;display:flex;align-items:center;justify-content:center}',""]),t.exports=e},ef9f:function(t,e,o){"use strict";var i=o("78d9"),n=o.n(i);n.a}}]);